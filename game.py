from OpenGL.GLUT import *
from OpenGL.GL import *
from OpenGL.GLU import *
import pygame
from libs.saveGame import *

# initializing glut and window because some imports depend on it
try:
    glutInit()
    pygame.mixer.init(frequency=22050, size=-16, channels=2, buffer=512)
    glutInitDisplayMode(GLUT_DOUBLE | GLUT_RGB | GLUT_DEPTH | GLUT_MULTISAMPLE)
    glutInitWindowSize(720, 500)
    glutInitWindowPosition(0, 0)
    glutCreateWindow(b"PHRIX3D")
except Error:
    raise Error

# continuing importing
from libs.misc import drawOnScreen
from libs.game import *


# will be deleted
# x, y, z = 2, -1, -4


def resize(w, h):
    glViewport(0, 0, w, h)
    glMatrixMode(GL_PROJECTION)
    glLoadIdentity()
    gluPerspective(60.0, w / h, 0.1, 300.0)
    glMatrixMode(GL_MODELVIEW)
    glLoadIdentity()


def Timer(v):
    glutPostRedisplay()
    glutTimerFunc(TIMER_INTERVAL_MS, Timer, v + 1)


def draw():
    glClearColor(0, 0, 0, 1)
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)
    game.player.camera.callPerspective()
    glPushMatrix()

    # game.sky.Draw(game.player.camera)
    px, py, pz = game.player.camera.cam_pos.tuple()
    glTranslate(px, py, pz)
    glCallList(game.sky.gl_list)
    # glEnable(GL_FOG)
    # glFogi(GL_FOG_MODE, GL_LINEAR)
    game.waterFog()
    # glFogi(GL_FOG_MODE, GL_EXP)
    # glFogf(GL_FOG_DENSITY, 0.3)
    light_position = (1922, 3354, 3391)
    glLightfv(GL_LIGHT0, GL_POSITION, light_position)
    glLightfv(GL_LIGHT0, GL_DIFFUSE, (0.001, 0.001, 0.001))
    # glLightfv(GL_LIGHT0,  GL_AMBIENT, (.1, .1, .1))
    glLightfv(GL_LIGHT0, GL_SPECULAR, (0.0005, 0.0005, 0.0005))
    # light_position = (1.0, 1.0, 2.0)
    # glLightfv(GL_LIGHT0, GL_SPOT_DIRECTION, light_position)

    glPopMatrix()
    glPushMatrix()
    glBindTexture(GL_TEXTURE_2D, game.terrain.texture)
    glPushAttrib(GL_CURRENT_BIT)
    glTranslate(32.0, game.terrain.heightPlus((32, 0, 32), 0), 32.0)
    glColor(.9, .4, .1, 1)
    # glutSolidTeapot(1)
    # glBegin(GL_POINTS)
    # v = "14.13953 0.9602054 9.476104 0.03441977 15.52822 0.03441977 15.52822 0.03441977 17.52197 0.9575839 14.13953 0.9602054 -7.560512 0.03441977 -25.35066 0.9575839 -30.79604 0.03441977 8.058596 0.9575839 -7.560512 0.03441977 9.476104 0.03441977 -9.36749 0.9575839 -15.24787 0.03441977 -9.309099 0.03441977 -15.24787 0.03441977 -18.15026 0.9575839 -21.17946 0.03441977 4.590273 0.03441977 19.19472 0.9497196 3.089859 0.9549624 4.590273 0.03441977 -9.36749 0.9575839 -9.309099 0.03441977 -10.58004 0.9575839 -15.89131 0.03441977 -10.36271 0.03441977 -15.89131 0.03441977 -18.75755 0.9575839 -19.91336 0.03441977 26.47776 0.9575839 6.872134 0.03441977 31.86892 0.03441977 7.03548 0.9575839 -10.36271 0.03441977 6.872134 0.03441977 -11.05672 0.03441977 -17.98427 0.9575839 -16.70746 0.03441977 -16.70746 0.03441977 -20.5664 0.9575839 -20.81834 0.03441977 6.558795 0.03441977 25.56247 0.9575839 6.08988 0.9575839 6.558795 0.03441977 -13.27486 0.9575839 -11.05672 0.03441977 15.15304 0.9575839 8.912107 0.03441977 14.81424 0.03441977 18.4189 0.9575839 14.81424 0.03441977 19.21974 0.03441977 -5.729352 0.03441977 -25.37661 0.9575839 -30.82143 0.03441977 -5.729352 0.03441977 9.120542 0.9575839 -5.844323 0.9575839 14.13953 0.9602054 9.476104 0.03441977 15.52822 0.03441977 15.52822 0.03441977 17.52197 0.9575839 14.13953 0.9602054 -7.560512 0.03441977 -25.35066 0.9575839 -30.79604 0.03441977 8.058596 0.9575839 -7.560512 0.03441977 9.476104 0.03441977 -9.36749 0.9575839 -15.24787 0.03441977 -9.309099 0.03441977 -15.24787 0.03441977 -18.15026 0.9575839 -21.17946 0.03441977 4.590273 0.03441977 19.19472 0.9497196 3.089859 0.9549624 4.590273 0.03441977 -9.36749 0.9575839 -9.309099 0.03441977 -10.58004 0.9575839 -15.89131 0.03441977 -10.36271 0.03441977 -15.89131 0.03441977 -18.75755 0.9575839 -19.91336 0.03441977 26.47776 0.9575839 6.872134 0.03441977 31.86892 0.03441977 7.03548 0.9575839 -10.36271 0.03441977 6.872134 0.03441977 -11.05672 0.03441977 -17.98427 0.9575839 -16.70746 0.03441977 -16.70746 0.03441977 -20.5664 0.9575839 -20.81834 0.03441977 6.558795 0.03441977 25.56247 0.9575839 6.08988 0.9575839 6.558795 0.03441977 -13.27486 0.9575839 -11.05672 0.03441977 15.15304 0.9575839 8.912107 0.03441977 14.81424 0.03441977 18.4189 0.9575839 14.81424 0.03441977 19.21974 0.03441977 -5.729352 0.03441977 -25.37661 0.9575839 -30.82143 0.03441977 -5.729352 0.03441977 9.120542 0.9575839 -5.844323 0.9575839 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 -2.808216 0.008047938 10.31657 0.9725005 -2.808216 0.9725005 -2.808216 0.008047938 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -19.96298 0.008047938 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 10.31657 0.008047938 -2.808216 0.9725005 -2.808216 0.008047938 -2.808216 0.9725005 -13.17745 0.008047938 -2.808216 0.008047938 -13.17745 0.9725005 -19.96298 0.008047938 -13.17745 0.008047938 10.31657 0.008047938 15.69545 0.9713536 19.16885 0.008047938 -2.808216 0.008047938 8.533994 0.969879 10.31657 0.008047938 -13.17745 0.008047938 -4.590789 0.9725005 -2.808216 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -13.17745 0.9725005 10.31657 0.008047938 16.21974 0.9765965 19.16885 0.008047938 -2.283931 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 -12.12888 0.9672577 -2.808216 0.008047938 -13.17745 0.008047938 -17.48573 0.9684045 -13.17745 0.008047938 -19.96298 0.008047938 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 -2.808216 0.008047938 10.31657 0.9725005 -3.332501 0.9725005 -2.808216 0.008047938 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -19.96298 0.008047938 10.97002 0.9852266 15.17235 0.0024001 15.17235 0.9799838 15.17235 0.9799838 19.86666 0.0024001 18.22826 0.9799838 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.0024001 -4.598458 0.9826052 -5.64703 0.0024001 10.13116 0.9799838 15.17235 0.0024001 10.13116 0.0024001 15.17235 0.0024001 18.22826 0.9799838 19.86666 0.0024001 -14.67839 0.9799838 -5.64703 0.0024001 -20.41277 0.0024001 -5.64703 0.0024001 10.13116 0.9799838 10.13116 0.0024001 15.17235 0.0024001 10.13116 0.9799838 10.13116 0.0024001 18.22826 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.9799838 -5.64703 0.0024001 10.13116 0.0024001 10.13116 0.0024001 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.0024001 18.22826 0.9799838 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -5.64703 0.9799838 -5.64703 0.9799838 10.13116 0.0024001 -5.64703 0.0024001 15.17235 0.9799838 10.13116 0.0024001 15.17235 0.0024001 18.22826 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.0024001 -5.64703 0.9799838 -5.64703 0.0024001 17.54761 0.002433478 12.11346 0.9575839 17.5476 0.9575839 17.54761 0.002433478 20.7625 0.9575839 22.52171 0.002433478 -3.642329 0.002433478 -12.77353 0.9523411 -1.964613 0.9575839 -3.642329 0.002433478 12.11346 0.9575839 12.11346 0.002433478 17.54761 0.002433478 12.11346 0.9575839 12.11346 0.002433478 21.29026 0.9575839 17.54761 0.002433478 22.52171 0.002433478 -3.642329 0.002433478 -14.34639 0.9575839 -20.23976 0.002433478 12.11346 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 12.11346 0.002433478 17.5476 0.9575839 17.54761 0.002433478 17.54761 0.002433478 21.02638 0.9575839 22.52171 0.002433478 -14.96211 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -3.642329 0.002433478 12.11346 0.9575839 12.11346 0.002433478 12.11346 0.002433478 19.28297 0.9549624 17.54761 0.002433478 17.54761 0.002433478 22.52171 0.9575839 22.52171 0.002433478 -3.642329 0.002433478 -16.01764 0.9575839 -3.642329 0.9575839 -3.642329 0.9575839 12.11346 0.002433478 -3.642329 0.002433478 18.51518 0.9575839 12.11346 0.002433478 17.54761 0.002433478 22.52171 0.9575839 17.54761 0.002433478 22.52171 0.002433478 -3.642329 0.002433478 -16.01764 0.9575839 -20.23976 0.002433478 -3.642329 0.002433478 13.52084 0.9575839 -3.642329 0.9575839 17.54761 0.002433478 12.11346 0.9575839 17.5476 0.9575839 17.54761 0.002433478 20.7625 0.9575839 22.52171 0.002433478 -3.642329 0.002433478 -12.77353 0.9523411 -1.964613 0.9575839 -3.642329 0.002433478 12.11346 0.9575839 12.11346 0.002433478 17.54761 0.002433478 12.11346 0.9575839 12.11346 0.002433478 21.29026 0.9575839 17.54761 0.002433478 22.52171 0.002433478 -3.642329 0.002433478 -14.34639 0.9575839 -20.23976 0.002433478 12.11346 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 12.11346 0.002433478 17.5476 0.9575839 17.54761 0.002433478 17.54761 0.002433478 21.02638 0.9575839 22.52171 0.002433478 -14.96211 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -3.642329 0.002433478 12.11346 0.9575839 12.11346 0.002433478 12.11346 0.002433478 19.28297 0.9549624 17.54761 0.002433478 17.54761 0.002433478 22.52171 0.9575839 22.52171 0.002433478 -3.642329 0.002433478 -16.01764 0.9575839 -3.642329 0.9575839 -3.642329 0.9575839 12.11346 0.002433478 -3.642329 0.002433478 18.51518 0.9575839 12.11346 0.002433478 17.54761 0.002433478 22.52171 0.9575839 17.54761 0.002433478 22.52171 0.002433478 -3.642329 0.002433478 -16.01764 0.9575839 -20.23976 0.002433478 -3.642329 0.002433478 13.52084 0.9575839 -3.642329 0.9575839 10.97002 0.9852266 15.17235 0.0024001 15.17235 0.9799838 15.17235 0.9799838 19.86666 0.0024001 18.22826 0.9799838 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.0024001 -4.598458 0.9826052 -5.64703 0.0024001 10.13116 0.9799838 15.17235 0.0024001 10.13116 0.0024001 15.17235 0.0024001 18.22826 0.9799838 19.86666 0.0024001 -14.67839 0.9799838 -5.64703 0.0024001 -20.41277 0.0024001 -5.64703 0.0024001 10.13116 0.9799838 10.13116 0.0024001 15.17235 0.0024001 10.13116 0.9799838 10.13116 0.0024001 18.22826 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.9799838 -5.64703 0.0024001 10.13116 0.0024001 10.13116 0.0024001 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.0024001 18.22826 0.9799838 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -5.64703 0.9799838 -5.64703 0.9799838 10.13116 0.0024001 -5.64703 0.0024001 15.17235 0.9799838 10.13116 0.0024001 15.17235 0.0024001 18.22826 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -14.67839 0.9799838 -20.41277 0.0024001 10.13116 0.0024001 -5.64703 0.9799838 -5.64703 0.0024001 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 -2.808216 0.008047938 10.31657 0.9725005 -2.808216 0.9725005 -2.808216 0.008047938 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -19.96298 0.008047938 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 10.31657 0.008047938 -2.808216 0.9725005 -2.808216 0.008047938 -2.808216 0.9725005 -13.17745 0.008047938 -2.808216 0.008047938 -13.17745 0.9725005 -19.96298 0.008047938 -13.17745 0.008047938 10.31657 0.008047938 15.69545 0.9713536 19.16885 0.008047938 -2.808216 0.008047938 8.533994 0.969879 10.31657 0.008047938 -13.17745 0.008047938 -4.590789 0.9725005 -2.808216 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -13.17745 0.9725005 10.31657 0.008047938 16.21974 0.9765965 19.16885 0.008047938 -2.283931 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 -12.12888 0.9672577 -2.808216 0.008047938 -13.17745 0.008047938 -17.48573 0.9684045 -13.17745 0.008047938 -19.96298 0.008047938 16.21974 0.9765965 10.31657 0.008047938 19.16885 0.008047938 -2.808216 0.008047938 10.31657 0.9725005 -3.332501 0.9725005 -2.808216 0.008047938 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.008047938 -18.32459 0.9684045 -19.96298 0.008047938 14.13953 0.9602054 8.058596 0.9575839 9.476104 0.03441977 15.52822 0.03441977 20.10548 0.03441977 17.52197 0.9575839 -7.560512 0.03441977 -8.862802 0.9575839 -25.35066 0.9575839 8.058596 0.9575839 -8.862802 0.9575839 -7.560512 0.03441977 -9.36749 0.9575839 -14.60553 0.9575839 -15.24787 0.03441977 -15.24787 0.03441977 -14.60553 0.9575839 -18.15026 0.9575839 4.590273 0.03441977 30.07802 0.03441977 19.19472 0.9497196 4.590273 0.03441977 3.089859 0.9549624 -9.36749 0.9575839 -10.58004 0.9575839 -16.23076 0.9575839 -15.89131 0.03441977 -15.89131 0.03441977 -16.23076 0.9575839 -18.75755 0.9575839 26.47776 0.9575839 7.03548 0.9575839 6.872134 0.03441977 7.03548 0.9575839 -10.58004 0.9575839 -10.36271 0.03441977 -11.05672 0.03441977 -13.27486 0.9575839 -17.98427 0.9575839 -16.70746 0.03441977 -17.98427 0.9575839 -20.5664 0.9575839 6.558795 0.03441977 31.85294 0.03441977 25.56247 0.9575839 6.558795 0.03441977 6.08988 0.9575839 -13.27486 0.9575839 15.15304 0.9575839 9.120542 0.9575839 8.912107 0.03441977 18.4189 0.9575839 15.15304 0.9575839 14.81424 0.03441977 -5.729352 0.03441977 -5.844323 0.9575839 -25.37661 0.9575839 -5.729352 0.03441977 8.912107 0.03441977 9.120542 0.9575839 14.13953 0.9602054 8.058596 0.9575839 9.476104 0.03441977 15.52822 0.03441977 20.10548 0.03441977 17.52197 0.9575839 -7.560512 0.03441977 -8.862802 0.9575839 -25.35066 0.9575839 8.058596 0.9575839 -8.862802 0.9575839 -7.560512 0.03441977 -9.36749 0.9575839 -14.60553 0.9575839 -15.24787 0.03441977 -15.24787 0.03441977 -14.60553 0.9575839 -18.15026 0.9575839 4.590273 0.03441977 30.07802 0.03441977 19.19472 0.9497196 4.590273 0.03441977 3.089859 0.9549624 -9.36749 0.9575839 -10.58004 0.9575839 -16.23076 0.9575839 -15.89131 0.03441977 -15.89131 0.03441977 -16.23076 0.9575839 -18.75755 0.9575839 26.47776 0.9575839 7.03548 0.9575839 6.872134 0.03441977 7.03548 0.9575839 -10.58004 0.9575839 -10.36271 0.03441977 -11.05672 0.03441977 -13.27486 0.9575839 -17.98427 0.9575839 -16.70746 0.03441977 -17.98427 0.9575839 -20.5664 0.9575839 6.558795 0.03441977 31.85294 0.03441977 25.56247 0.9575839 6.558795 0.03441977 6.08988 0.9575839 -13.27486 0.9575839 15.15304 0.9575839 9.120542 0.9575839 8.912107 0.03441977 18.4189 0.9575839 15.15304 0.9575839 14.81424 0.03441977 -5.729352 0.03441977 -5.844323 0.9575839 -25.37661 0.9575839 -5.729352 0.03441977 8.912107 0.03441977 9.120542 0.9575839 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.008047938 -2.808216 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.9725005 -2.808216 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045 -19.96298 0.008047938 10.31657 0.008047938 8.533994 0.969879 15.69545 0.9713536 -2.808216 0.008047938 -4.590789 0.9725005 8.533994 0.969879 -13.17745 0.008047938 -13.17745 0.9725005 -4.590789 0.9725005 -13.17745 0.008047938 -19.96298 0.008047938 -18.32459 0.9684045 10.31657 0.008047938 10.31657 0.9725005 16.21974 0.9765965 -2.283931 0.9725005 10.31657 0.9725005 10.31657 0.008047938 -12.12888 0.9672577 -2.283931 0.9725005 -2.808216 0.008047938 -17.48573 0.9684045 -12.12888 0.9672577 -13.17745 0.008047938 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.008047938 -3.332501 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045 10.97002 0.9852266 10.13116 0.0024001 15.17235 0.0024001 15.17235 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -4.598458 0.9826052 -14.67839 0.9799838 10.13116 0.0024001 10.97002 0.9852266 -4.598458 0.9826052 10.13116 0.9799838 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.0024001 15.17235 0.9799838 18.22826 0.9799838 -14.67839 0.9799838 -5.64703 0.9799838 -5.64703 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 10.13116 0.9799838 15.17235 0.0024001 15.17235 0.9799838 10.13116 0.9799838 18.22826 0.9799838 15.17235 0.9799838 15.17235 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 -14.67839 0.9799838 10.13116 0.9799838 -5.64703 0.9799838 -5.64703 0.0024001 10.13116 0.0024001 10.13116 0.9799838 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.9799838 18.22826 0.9799838 -5.64703 0.0024001 -20.41277 0.0024001 -14.67839 0.9799838 -5.64703 0.9799838 10.13116 0.9799838 10.13116 0.0024001 15.17235 0.9799838 10.13116 0.9799838 10.13116 0.0024001 18.22826 0.9799838 15.17235 0.9799838 15.17235 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 -14.67839 0.9799838 10.13116 0.0024001 10.13116 0.9799838 -5.64703 0.9799838 17.54761 0.002433478 12.11346 0.002433478 12.11346 0.9575839 17.54761 0.002433478 17.5476 0.9575839 20.7625 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -12.77353 0.9523411 -3.642329 0.002433478 -1.964613 0.9575839 12.11346 0.9575839 17.54761 0.002433478 17.5476 0.9575839 12.11346 0.9575839 21.29026 0.9575839 17.5476 0.9575839 17.54761 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 -14.34639 0.9575839 12.11346 0.9575839 -3.642329 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 12.11346 0.9575839 17.5476 0.9575839 17.54761 0.002433478 17.5476 0.9575839 21.02638 0.9575839 -14.96211 0.9575839 -3.642329 0.9575839 -3.642329 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 12.11346 0.9575839 12.11346 0.002433478 13.34491 0.9575839 19.28297 0.9549624 17.54761 0.002433478 19.28297 0.9549624 22.52171 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -16.01764 0.9575839 -3.642329 0.9575839 13.34491 0.9575839 12.11346 0.002433478 18.51518 0.9575839 13.52084 0.9575839 12.11346 0.002433478 22.52171 0.9575839 18.51518 0.9575839 17.54761 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 -16.01764 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 13.52084 0.9575839 17.54761 0.002433478 12.11346 0.002433478 12.11346 0.9575839 17.54761 0.002433478 17.5476 0.9575839 20.7625 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -12.77353 0.9523411 -3.642329 0.002433478 -1.964613 0.9575839 12.11346 0.9575839 17.54761 0.002433478 17.5476 0.9575839 12.11346 0.9575839 21.29026 0.9575839 17.5476 0.9575839 17.54761 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 -14.34639 0.9575839 12.11346 0.9575839 -3.642329 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 12.11346 0.9575839 17.5476 0.9575839 17.54761 0.002433478 17.5476 0.9575839 21.02638 0.9575839 -14.96211 0.9575839 -3.642329 0.9575839 -3.642329 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 12.11346 0.9575839 12.11346 0.002433478 13.34491 0.9575839 19.28297 0.9549624 17.54761 0.002433478 19.28297 0.9549624 22.52171 0.9575839 -3.642329 0.002433478 -20.23976 0.002433478 -16.01764 0.9575839 -3.642329 0.9575839 13.34491 0.9575839 12.11346 0.002433478 18.51518 0.9575839 13.52084 0.9575839 12.11346 0.002433478 22.52171 0.9575839 18.51518 0.9575839 17.54761 0.002433478 -3.642329 0.002433478 -3.642329 0.9575839 -16.01764 0.9575839 -3.642329 0.002433478 12.11346 0.002433478 13.52084 0.9575839 10.97002 0.9852266 10.13116 0.0024001 15.17235 0.0024001 15.17235 0.9799838 15.17235 0.0024001 19.86666 0.0024001 -5.64703 0.0024001 -4.598458 0.9826052 -14.67839 0.9799838 10.13116 0.0024001 10.97002 0.9852266 -4.598458 0.9826052 10.13116 0.9799838 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.0024001 15.17235 0.9799838 18.22826 0.9799838 -14.67839 0.9799838 -5.64703 0.9799838 -5.64703 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 10.13116 0.9799838 15.17235 0.0024001 15.17235 0.9799838 10.13116 0.9799838 18.22826 0.9799838 15.17235 0.9799838 15.17235 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 -14.67839 0.9799838 10.13116 0.9799838 -5.64703 0.9799838 -5.64703 0.0024001 10.13116 0.0024001 10.13116 0.9799838 15.17235 0.9799838 15.17235 0.0024001 15.17235 0.9799838 18.22826 0.9799838 -5.64703 0.0024001 -20.41277 0.0024001 -14.67839 0.9799838 -5.64703 0.9799838 10.13116 0.9799838 10.13116 0.0024001 15.17235 0.9799838 10.13116 0.9799838 10.13116 0.0024001 18.22826 0.9799838 15.17235 0.9799838 15.17235 0.0024001 -5.64703 0.0024001 -5.64703 0.9799838 -14.67839 0.9799838 10.13116 0.0024001 10.13116 0.9799838 -5.64703 0.9799838 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.008047938 -2.808216 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.9725005 -2.808216 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045 -19.96298 0.008047938 10.31657 0.008047938 8.533994 0.969879 15.69545 0.9713536 -2.808216 0.008047938 -4.590789 0.9725005 8.533994 0.969879 -13.17745 0.008047938 -13.17745 0.9725005 -4.590789 0.9725005 -13.17745 0.008047938 -19.96298 0.008047938 -18.32459 0.9684045 10.31657 0.008047938 10.31657 0.9725005 16.21974 0.9765965 -2.283931 0.9725005 10.31657 0.9725005 10.31657 0.008047938 -12.12888 0.9672577 -2.283931 0.9725005 -2.808216 0.008047938 -17.48573 0.9684045 -12.12888 0.9672577 -13.17745 0.008047938 16.21974 0.9765965 10.31657 0.9725005 10.31657 0.008047938 -2.808216 0.008047938 10.31657 0.008047938 10.31657 0.9725005 -2.808216 0.008047938 -3.332501 0.9725005 -13.17745 0.9725005 -13.17745 0.008047938 -13.17745 0.9725005 -18.32459 0.9684045".split(
    # 	" ")
    # for i in range(0, len(v), 3):
    # 	glVertex3d(float(v[i]), float(v[i + 1]), float(v[i + 2]))
    # glEnd()
    glPopAttrib()
    glPopMatrix()

    # record
    rec.loop()

    game.loop()
    # drawOnScreen(game, x, y, z)
    if game.firstFrame:
        game.saveGame()
        game.firstFrame = False
    drawOnScreen(game, 0, 0, 0)
    glutSwapBuffers()

    # # will be deleted
    # def pressedKey(key, xx, yy):
    #     global x, y, z
    #     key = key.decode("utf8").lower()
    #     if key == "e":
    #         x += 0.4
    #     if key == "r":
    #         x -= 0.4
    #     if key == "t":
    #         y += 0.4
    #     if key == "y":
    #         y -= 0.4
    #     if key == "u":
    #         z += 0.4
    #     if key == "i":
    #         z -= 0.4


def pressedKey(key, xx, yy):
    if not rec.playing:
        try:
            key = key.decode("utf8").lower()
        except:
            key = ""

        if key == "w":
            game.player.forward = True
        if key == "s":
            game.player.backward = True

        if key == "a":
            game.player.left = True
        if key == "d":
            game.player.right = True
        if key == " ":
            game.player.jump = True
        if key == "r":
            game.player.gun.forceReload = True

        # debugging
        if key == "8":
            game.z -= 0.001
        if key == "2":
            game.z += 0.001
        if key == "6":
            game.x += 0.001
        if key == "4":
            game.x -= 0.001
        if key == "1":
            game.y += 0.001
        if key == "0":
            game.y -= 0.001
        if key == "+":
            game.p += 0.001
        if key == "-":
            game.p -= 0.001
        if key == "7":
            game.d -= 0.1
        if key == "9":
            game.d += 0.1

        if key == "l":
            game.modifiers["L"] = True
        if key == chr(27):
            glutLeaveMainLoop()


def releasedKey(key, x, y):
    if not rec.playing:
        try:
            key = key.decode("utf8").lower()
        except:
            return
        if key == "w":
            game.player.forward = False
        if key == "s":
            game.player.backward = False
        if key == "a":
            game.player.left = False
        if key == "d":
            game.player.right = False
        # if key == " ":
        #     self.jump = False
        if key == "r":
            game.player.gun.forceReload = False
        if key == "l":
            game.modifiers["L"] = False
        game.lastEightChars.append(key)
        game.lastEightChars.pop(0)


def specialPressedKey(key, x, y):
    if not rec.playing:
        mod = glutGetModifiers()
        if mod == GLUT_ACTIVE_SHIFT:
            game.player.running = True
        if mod == GLUT_ACTIVE_CTRL:
            game.modifiers["CTRL"] = True
        if mod == GLUT_ACTIVE_ALT:
            game.modifiers["ALT"] = True
        if key == GLUT_KEY_F1:
            if rec.isRecording():
                rec.stopRec()
            else:
                rec.startRec()
            # game.modifiers["F1"] = True
        if key == GLUT_KEY_F2:
            if not rec.isPlaying():
                rec.playFromList()

            # game.modifiers["F2"] = True


def specialReleasedKey(key, x, y):
    if not rec.playing:
        mod = glutGetModifiers()
        if mod != GLUT_ACTIVE_SHIFT:
            game.player.running = False
        if mod != GLUT_ACTIVE_CTRL:
            game.modifiers["CTRL"] = False
        if mod != GLUT_ACTIVE_ALT:
            game.modifiers["ALT"] = False
        if key == GLUT_KEY_F1:
            game.modifiers["F1"] = False
        if key == GLUT_KEY_F2:
            game.modifiers["F2"] = False
        if key == GLUT_KEY_F4:
            glutFullScreenToggle()


def mouseLookCallBack(xpos, ypos):
    if not rec.playing:
        if game.player.firstMovement:
            game.player.lastX = xpos
            game.player.lastY = ypos
            game.player.firstMovement = False
        game.player.camera.xOffset = xpos - game.player.lastX
        game.player.camera.yOffset = game.player.lastY - ypos
        game.player.camera.processMouseMotion()
        glutWarpPointer(350, 200)
        game.player.lastX = 350
        game.player.lastY = 200


def mouseButtonCallback(button, state, x, y):
    if not rec.playing:
        if state == GLUT_DOWN:
            if button == GLUT_RIGHT_BUTTON:
                pass
            if button == GLUT_LEFT_BUTTON:
                game.player.triggering = True

        if state == GLUT_UP:
            if button == GLUT_RIGHT_BUTTON:
                pass
            if button == GLUT_LEFT_BUTTON:
                pass
        else:
            pass
        glutPostRedisplay()


def loadingLoop():
    glMatrixMode(GL_PROJECTION)
    glLoadIdentity()
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT)
    glClearColor(1, 0, 0, 0)

    drawRect(1 * width / height, 1)
    glColor3f(0, 1, 0)
    glutSwapBuffers()


glutTimerFunc(TIMER_INTERVAL_MS, Timer, 1)

# terrain = Terrain("textures/volc.jpg", "textures/volcH.JPG", "textures/SAND-01-270/SAND-01-270cm/SAND-01-270cm_Color_4k.jpg")
# terrain = Terrain("textures/volc.jpg", "textures/volcH.JPG", "textures/rdt4 color/BURNED-FORESTFLOOR-01_COLOR_4k.jpg")


# gun = OBJ("Pistol.obj")
# gun = OBJ("Handgun_obj.obj")

# model = Robot()
# model.load("C:\\Users\\agour\\Desktop\\pygame\\hdr\\gun")


glutReshapeFunc(resize)
glutSetKeyRepeat(0)
glEnable(GL_LIGHTING)

glEnable(GL_LIGHT0)
glEnable(GL_LIGHT1)
glEnable(GL_FOG)
glEnable(GL_COLOR_MATERIAL)
glEnable(GL_DEPTH_TEST)
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA)
# glEnable(GL_DEPTH_TEST)
# glAlphaFunc(GL_GREATER, 0.3)
glutSetOption(GLUT_MULTISAMPLE, 8)

glutFullScreen()
# glutIdleFunc(process)
# glutDisplayFunc(loadingLoop)
# glutMainLoop()

game = Game()
rec = Record(game)

# KEYBOARD
glutSpecialFunc(specialPressedKey)
glutSpecialUpFunc(specialReleasedKey)
# glutKeyboardFunc(pressedKey)
glutKeyboardFunc(pressedKey)
glutKeyboardUpFunc(releasedKey)

# MOUSE
glutPassiveMotionFunc(mouseLookCallBack)
glutMotionFunc(mouseLookCallBack)
glutSetCursor(GLUT_CURSOR_NONE)
glutMouseFunc(mouseButtonCallback)

glutDisplayFunc(draw)
glutMainLoop()
